<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Special Rakhi Wish!</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@400;600&display=swap');

        :root {
            --bg-start: #6a11cb;
            --bg-end: #2575fc;
            --card-bg: rgba(255, 255, 255, 0.1);
            --text-color: #f0e6ff;
            --heading-color: #ffffff;
            --accent-color: #f7b733;
            --shadow-color: rgba(0, 0, 0, 0.25);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            height: 100vh;
            font-family: 'Montserrat', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            background: linear-gradient(-45deg, var(--bg-start), var(--bg-end), #fc466b, #3f5efb);
            background-size: 400% 400%;
            animation: gradientBG 20s ease infinite;
            overflow: hidden;
            perspective: 1200px;
            flex-direction: column;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        /* --- Curtain --- */
        .curtain-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 100;
            pointer-events: none;
        }

        .curtain {
            position: absolute;
            top: 0;
            width: 50%;
            height: 100%;
            background: #8e2de2;
            transition: transform 2s cubic-bezier(0.86, 0, 0.07, 1);
        }

        .curtain-left {
            left: 0;
            background: linear-gradient(to right, #4a00e0, #8e2de2);
        }

        .curtain-right {
            right: 0;
            background: linear-gradient(to left, #4a00e0, #8e2de2);
        }
        
        body.scene-open .curtain-left { transform: translateX(-100%); }
        body.scene-open .curtain-right { transform: translateX(100%); }
        
        /* --- Screens --- */
        .screen {
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            width: 90%;
            max-width: 450px;
            padding: 30px;
            background: var(--card-bg);
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px 0 var(--shadow-color);
        }
        
        .screen.active {
            display: flex;
            animation: fadeInScaleUp 1s 1.5s forwards;
        }

        @keyframes fadeInScaleUp {
            from { opacity: 0; transform: scale(0.8) rotateX(-20deg); }
            to { opacity: 1; transform: scale(1) rotateX(0deg); }
        }

        /* --- Name Screen --- */
        #name-screen h1 {
            font-family: 'Dancing Script', cursive;
            color: var(--heading-color);
            font-size: 3em;
            margin-bottom: 20px;
        }
        
        .input-group { width: 100%; margin-bottom: 20px; }

        .input-field {
            width: 100%;
            padding: 15px;
            background: transparent;
            border: 2px solid rgba(255, 255, 255, 0.5);
            border-radius: 10px;
            color: var(--heading-color);
            font-size: 1.1em;
            text-align: center;
            transition: all 0.3s;
        }
        
        .input-field::placeholder { color: rgba(255, 255, 255, 0.7); }
        .input-field:focus {
            outline: none;
            border-color: var(--accent-color);
            transform: scale(1.05);
        }

        .main-btn {
            padding: 15px 40px;
            border-radius: 50px;
            border: none;
            background: var(--accent-color);
            color: #333;
            font-size: 1.2em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        
        .main-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
        }
        
        /* --- Card Screen --- */
        #card-screen.active {
            animation: fadeInScaleUp 1s forwards;
        }

        .card-inner { transition: transform 0.5s; }
        .card-inner h1 {
            font-family: 'Dancing Script', cursive;
            font-size: 2.8em;
            color: var(--heading-color);
            margin-bottom: 25px;
            animation: slideInDown 1s 0.5s forwards;
        }
        
        .rakhi-svg {
            width: 120px;
            margin: 20px auto;
            animation: pulse-grow 2.5s infinite ease-in-out, slideInDown 1s 0.8s forwards;
        }
        
        #message-p {
            color: var(--text-color);
            font-size: 1.1em;
            line-height: 1.7;
            height: 100px;
            animation: slideInUp 1s 1s forwards;
        }

        #sender-p {
            font-weight: 600;
            font-size: 1.2em;
            color: var(--heading-color);
            margin-top: 30px;
            animation: slideInUp 1s 1.2s forwards;
        }

        #share-container {
            margin-top: 40px;
            opacity: 0;
            animation: fadeIn 1s 2.5s forwards;
        }

        /* --- General Animations --- */
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes slideInDown {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        @keyframes pulse-grow {
            0%, 100% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.1); filter: brightness(1.2); }
        }
        
    </style>
</head>
<body class="">

    <div class="curtain-container">
        <div class="curtain curtain-left"></div>
        <div class="curtain curtain-right"></div>
    </div>
    
    <div id="name-screen" class="screen">
        <h1>A Wish For You</h1>
        <div class="input-group">
            <input type="text" id="receiverNameInput" class="input-field" placeholder="Enter Sibling's Name">
        </div>
        <div class="input-group">
            <input type="text" id="senderNameInput" class="input-field" placeholder="Enter Your Name">
        </div>
        <button id="createCardBtn" class="main-btn">Create Magic</button>
    </div>

    <div id="card-screen" class="screen">
        <div id="card-inner" class="card-inner">
            <h1 id="greeting-h1">Happy Raksha Bandhan!</h1>
            
            <svg class="rakhi-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                <circle cx="50" cy="50" r="30" fill="#ff7e5f"/>
                <circle cx="50" cy="50" r="20" fill="#feb47b"/>
                <circle cx="50" cy="50" r="10" fill="#f7b733"/>
                <g fill="#ff7e5f">
                    <rect x="47" y="0" width="6" height="20" rx="3"/>
                    <rect x="47" y="80" width="6" height="20" rx="3"/>
                    <rect x="0" y="47" width="20" height="6" rx="3"/>
                    <rect x="80" y="47" width="20" height="6" rx="3"/>
                </g>
            </svg>
            
            <p id="message-p"></p>
            <p id="sender-p"></p>
            
            <div id="share-container" style="display: none;">
                <button id="shareBtn" class="main-btn">Share This Wish</button>
            </div>
        </div>
    </div>

    <audio id="bg-music" loop>
        <source src="https://assets.mixkit.co/music/preview/mixkit-a-new-beginning-29.mp3" type="audio/mpeg">
    </audio>
    
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Elements
            const body = document.body;
            const nameScreen = document.getElementById('name-screen');
            const cardScreen = document.getElementById('card-screen');
            const createCardBtn = document.getElementById('createCardBtn');
            const music = document.getElementById('bg-music');
            
            const receiverInput = document.getElementById('receiverNameInput');
            const senderInput = document.getElementById('senderNameInput');

            // --- Typewriter Effect ---
            let typeTimeout;
            function typewriter(text, element, callback) {
                clearTimeout(typeTimeout);
                let i = 0;
                element.innerHTML = "";
                function type() {
                    if (i < text.length) {
                        element.innerHTML += text.charAt(i);
                        i++;
                        typeTimeout = setTimeout(type, 50);
                    } else if(callback) {
                        callback();
                    }
                }
                type();
            }

            // --- The main logic ---
            function startExperience(isViewer) {
                body.classList.add('scene-open');

                const params = new URLSearchParams(window.location.search);
                const receiverName = params.get('r') || receiverInput.value.trim() || "My Dearest Sibling";
                const senderName = params.get('s') || senderInput.value.trim() || "Me";
                
                // Show form if not a viewer, otherwise go straight to card
                if (!isViewer) {
                    nameScreen.classList.add('active');
                } else {
                    displayCard(receiverName, senderName, true);
                }

                // Attach event listener for form submission
                createCardBtn.addEventListener('click', () => {
                     const rName = receiverInput.value.trim() || "My Dearest Sibling";
                     const sName = senderInput.value.trim() || "Me";
                     displayCard(rName, sName, false);
                });
            }

            function displayCard(receiver, sender, isViewer) {
                // Animate out the name screen
                nameScreen.style.animation = 'fadeOutScaleDown 0.5s forwards';
                nameScreen.addEventListener('animationend', () => nameScreen.classList.remove('active'), { once: true });
                
                // Show and animate in the card screen
                cardScreen.classList.add('active');

                // Personalize the card
                document.getElementById('greeting-h1').textContent = `Dear ${receiver},`;
                const message = `On this special day, I'm sending you all my love. May our bond remain as strong and beautiful as ever. Happy Rakhi!`;
                typewriter(message, document.getElementById('message-p'), () => {
                    document.getElementById('sender-p').innerHTML = `With love,<br>${sender}`;
                });
                
                // Play music on interaction
                music.play().catch(e => console.warn("Audio play was blocked."));

                // Logic for showing/hiding share button
                if (!isViewer) {
                    const shareContainer = document.getElementById('share-container');
                    const shareBtn = document.getElementById('shareBtn');
                    shareContainer.style.display = 'block';

                    shareBtn.onclick = () => {
                        const url = `${window.location.origin}${window.location.pathname}?r=${encodeURIComponent(receiver)}&s=${encodeURIComponent(sender)}`;
                        navigator.clipboard.writeText(url).then(() => {
                            shareBtn.textContent = 'Link Copied!';
                            setTimeout(() => { shareBtn.textContent = 'Share This Wish'; }, 2000);
                        }).catch(err => {
                             alert('Could not copy link. Please do it manually.');
                        });
                    };
                }

                // Parallax effect on card
                const cardInner = document.getElementById('card-inner');
                cardScreen.addEventListener('mousemove', (e) => {
                    const { left, top, width, height } = cardScreen.getBoundingClientRect();
                    const x = (e.clientX - left - width / 2) / width * 2;
                    const y = (e.clientY - top - height / 2) / height * 2;
                    cardInner.style.transform = `rotateY(${x * 5}deg) rotateX(${-y * 5}deg)`;
                });
            }

            // Check if loaded from a share link
            const urlParams = new URLSearchParams(window.location.search);
            if (urlParams.has('r') && urlParams.has('s')) {
                startExperience(true);
            } else {
                startExperience(false);
            }
        });
    </script>
</body>
    </html>
